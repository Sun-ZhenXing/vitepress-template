import{_assignValue_default as e,_baseAssignValue_default as t,_baseFor_default as n,_baseGetTag_default as r,_baseKeys_default as i,_baseRest_default as a,_baseUnary_default as o,_getTag_default as s,_isIndex_default as c,_isIterateeCall_default as l,_overRest_default as u,_root_default as d,_setToString_default as f,constant_default as p,eq_default as m,identity_default as ee,isArrayLike_default as h,isArray_default as g,isObjectLike_default as te,isObject_default as _,keysIn_default as ne,merge_default as v}from"./mermaid-b5860b54.CzyV0eq4.js";import{Graph as y,_arrayMap_default as b,_baseClone_default as re,_baseEach_default as ie,_baseFindIndex_default as ae,_baseFlatten_default as oe,_baseForOwn_default as se,_baseGet_default as ce,_baseIteratee_default as x,_baseProperty_default as le,_castFunction_default as ue,_castPath_default as de,_toKey_default as fe,filter_default as S,forEach_default as C,hasIn_default as pe,has_default as w,isSymbol_default as T,isUndefined_default as E,keys_default as me,reduce_default as D,toString_default as he,values_default as O}from"./graphlib.B9UfIqo0.js";var ge=/\s/;function _e(e){for(var t=e.length;t--&&ge.test(e.charAt(t)););return t}var ve=_e,ye=/^\s+/;function be(e){return e&&e.slice(0,ve(e)+1).replace(ye,``)}var xe=be,Se=NaN,Ce=/^[-+]0x[0-9a-f]+$/i,we=/^0b[01]+$/i,Te=/^0o[0-7]+$/i,Ee=parseInt;function De(e){if(typeof e==`number`)return e;if(T(e))return Se;if(_(e)){var t=typeof e.valueOf==`function`?e.valueOf():e;e=_(t)?t+``:t}if(typeof e!=`string`)return e===0?e:+e;e=xe(e);var n=we.test(e);return n||Te.test(e)?Ee(e.slice(2),n?2:8):Ce.test(e)?Se:+e}var Oe=De,ke=1/0,Ae=17976931348623157e292;function je(e){if(!e)return e===0?e:0;if(e=Oe(e),e===ke||e===-ke){var t=e<0?-1:1;return t*Ae}return e===e?e:0}var k=je;function Me(e){var t=k(e),n=t%1;return t===t?n?t-n:t:0}var Ne=Me;function Pe(e){var t=e==null?0:e.length;return t?oe(e,1):[]}var A=Pe;function Fe(e){return f(u(e,void 0,A),e+``)}var Ie=Fe,Le=`\\ud800-\\udfff`,Re=`\\u0300-\\u036f`,ze=`\\ufe20-\\ufe2f`,Be=`\\u20d0-\\u20ff`,Ve=Re+ze+Be,He=`\\ufe0e\\ufe0f`,Ue=`\\u200d`,We=RegExp(`[`+Ue+Le+Ve+He+`]`);function Ge(e){return We.test(e)}var Ke=Ge,qe=1,Je=4;function Ye(e){return re(e,qe|Je)}var Xe=Ye,Ze=function(){return d.Date.now()},Qe=Ze,$e=Object.prototype,et=$e.hasOwnProperty,tt=a(function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&l(t[0],t[1],i)&&(r=1);++n<r;)for(var a=t[n],o=ne(a),s=-1,c=o.length;++s<c;){var u=o[s],d=e[u];(d===void 0||m(d,$e[u])&&!et.call(e,u))&&(e[u]=a[u])}return e}),nt=tt;function rt(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var j=rt;function it(e){return function(t,n,r){var i=Object(t);if(!h(t)){var a=x(n,3);t=me(t),n=function(e){return a(i[e],e,i)}}var o=e(t,n,r);return o>-1?i[a?t[o]:o]:void 0}}var at=it,ot=Math.max;function st(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var i=n==null?0:Ne(n);return i<0&&(i=ot(r+i,0)),ae(e,x(t,3),i)}var ct=st,lt=at(ct),ut=lt;function dt(e,t){var n=-1,r=h(e)?Array(e.length):[];return ie(e,function(e,i,a){r[++n]=t(e,i,a)}),r}var ft=dt;function pt(e,t){var n=g(e)?b:ft;return n(e,x(t,3))}var M=pt;function mt(e,t){return e==null?e:n(e,ue(t),ne)}var ht=mt;function gt(e,t){return e&&se(e,ue(t))}var _t=gt;function vt(e,t){return e>t}var yt=vt,bt=`[object String]`;function xt(e){return typeof e==`string`||!g(e)&&te(e)&&r(e)==bt}var St=xt;function Ct(e,t){return e<t}var wt=Ct;function Tt(e,n){var r={};return n=x(n,3),se(e,function(e,i,a){t(r,i,n(e,i,a))}),r}var N=Tt;function Et(e,t,n){for(var r=-1,i=e.length;++r<i;){var a=e[r],o=t(a);if(o!=null&&(s===void 0?o===o&&!T(o):n(o,s)))var s=o,c=a}return c}var P=Et;function Dt(e){return e&&e.length?P(e,ee,yt):void 0}var F=Dt;function Ot(e){return e&&e.length?P(e,ee,wt):void 0}var I=Ot;function kt(e,t){return e&&e.length?P(e,x(t,2),wt):void 0}var L=kt;function At(t,n,r,i){if(!_(t))return t;n=de(n,t);for(var a=-1,o=n.length,s=o-1,l=t;l!=null&&++a<o;){var u=fe(n[a]),d=r;if(u===`__proto__`||u===`constructor`||u===`prototype`)return t;if(a!=s){var f=l[u];d=i?i(f,u,l):void 0,d===void 0&&(d=_(f)?f:c(n[a+1])?[]:{})}e(l,u,d),l=l[u]}return t}var jt=At;function Mt(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=ce(e,o);n(s,o)&&jt(a,de(o,e),s)}return a}var Nt=Mt;function Pt(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var Ft=Pt;function It(e,t){if(e!==t){var n=e!==void 0,r=e===null,i=e===e,a=T(e),o=t!==void 0,s=t===null,c=t===t,l=T(t);if(!s&&!l&&!a&&e>t||a&&o&&c&&!s&&!l||r&&o&&c||!n&&c||!i)return 1;if(!r&&!a&&!l&&e<t||l&&n&&i&&!r&&!a||s&&n&&i||!o&&i||!c)return-1}return 0}var Lt=It;function Rt(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var c=Lt(i[r],a[r]);if(c){if(r>=s)return c;var l=n[r];return c*(l==`desc`?-1:1)}}return e.index-t.index}var zt=Rt;function Bt(e,t,n){t=t.length?b(t,function(e){return g(e)?function(t){return ce(t,e.length===1?e[0]:e)}:e}):[ee];var r=-1;t=b(t,o(x));var i=ft(e,function(e,n,i){var a=b(t,function(t){return t(e)});return{criteria:a,index:++r,value:e}});return Ft(i,function(e,t){return zt(e,t,n)})}var Vt=Bt,Ht=le(`length`),Ut=Ht,Wt=`\\ud800-\\udfff`,Gt=`\\u0300-\\u036f`,Kt=`\\ufe20-\\ufe2f`,qt=`\\u20d0-\\u20ff`,Jt=Gt+Kt+qt,Yt=`\\ufe0e\\ufe0f`,Xt=`[`+Wt+`]`,R=`[`+Jt+`]`,z=`\\ud83c[\\udffb-\\udfff]`,Zt=`(?:`+R+`|`+z+`)`,Qt=`[^`+Wt+`]`,$t=`(?:\\ud83c[\\udde6-\\uddff]){2}`,en=`[\\ud800-\\udbff][\\udc00-\\udfff]`,tn=`\\u200d`,nn=Zt+`?`,rn=`[`+Yt+`]?`,an=`(?:`+tn+`(?:`+[Qt,$t,en].join(`|`)+`)`+rn+nn+`)*`,on=rn+nn+an,sn=`(?:`+[Qt+R+`?`,R,$t,en,Xt].join(`|`)+`)`,cn=RegExp(z+`(?=`+z+`)|`+sn+on,`g`);function ln(e){for(var t=cn.lastIndex=0;cn.test(e);)++t;return t}var un=ln;function dn(e){return Ke(e)?un(e):Ut(e)}var fn=dn;function pn(e,t){return Nt(e,t,function(t,n){return pe(e,n)})}var mn=pn,hn=Ie(function(e,t){return e==null?{}:mn(e,t)}),B=hn,gn=Math.ceil,_n=Math.max;function vn(e,t,n,r){for(var i=-1,a=_n(gn((t-e)/(n||1)),0),o=Array(a);a--;)o[r?a:++i]=e,e+=n;return o}var yn=vn;function bn(e){return function(t,n,r){return r&&typeof r!=`number`&&l(t,n,r)&&(n=r=void 0),t=k(t),n===void 0?(n=t,t=0):n=k(n),r=r===void 0?t<n?1:-1:k(r),yn(t,n,r,e)}}var xn=bn,Sn=xn(),V=Sn,Cn=`[object Map]`,wn=`[object Set]`;function Tn(e){if(e==null)return 0;if(h(e))return St(e)?fn(e):e.length;var t=s(e);return t==Cn||t==wn?e.size:i(e).length}var En=Tn,Dn=a(function(e,t){if(e==null)return[];var n=t.length;return n>1&&l(e,t[0],t[1])?t=[]:n>2&&l(t[0],t[1],t[2])&&(t=[t[0]]),Vt(e,oe(t,1),[])}),H=Dn,On=0;function kn(e){var t=++On;return he(e)+t}var U=kn;function An(e,t,n){for(var r=-1,i=e.length,a=t.length,o={};++r<i;){var s=r<a?t[r]:void 0;n(o,e[r],s)}return o}var jn=An;function Mn(t,n){return jn(t||[],n||[],e)}var Nn=Mn,Pn=class{constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,t=e._prev;if(t!==e)return Fn(t),t}enqueue(e){var t=this._sentinel;e._prev&&e._next&&Fn(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t}toString(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,In)),n=n._prev;return`[`+e.join(`, `)+`]`}};function Fn(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function In(e,t){if(e!==`_next`&&e!==`_prev`)return t}var Ln=p(1);function Rn(e,t){if(e.nodeCount()<=1)return[];var n=Bn(e,t||Ln),r=zn(n.graph,n.buckets,n.zeroIdx);return A(M(r,function(t){return e.outEdges(t.v,t.w)}))}function zn(e,t,n){for(var r=[],i=t[t.length-1],a=t[0],o;e.nodeCount();){for(;o=a.dequeue();)W(e,t,n,o);for(;o=i.dequeue();)W(e,t,n,o);if(e.nodeCount()){for(var s=t.length-2;s>0;--s)if(o=t[s].dequeue(),o){r=r.concat(W(e,t,n,o,!0));break}}}return r}function W(e,t,n,r,i){var a=i?[]:void 0;return C(e.inEdges(r.v),function(r){var o=e.edge(r),s=e.node(r.v);i&&a.push({v:r.v,w:r.w}),s.out-=o,G(t,n,s)}),C(e.outEdges(r.v),function(r){var i=e.edge(r),a=r.w,o=e.node(a);o.in-=i,G(t,n,o)}),e.removeNode(r.v),a}function Bn(e,t){var n=new y,r=0,i=0;C(e.nodes(),function(e){n.setNode(e,{v:e,in:0,out:0})}),C(e.edges(),function(e){var a=n.edge(e.v,e.w)||0,o=t(e),s=a+o;n.setEdge(e.v,e.w,s),i=Math.max(i,n.node(e.v).out+=o),r=Math.max(r,n.node(e.w).in+=o)});var a=V(i+r+3).map(function(){return new Pn}),o=r+1;return C(n.nodes(),function(e){G(a,o,n.node(e))}),{graph:n,buckets:a,zeroIdx:o}}function G(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function Vn(e){var t=e.graph().acyclicer===`greedy`?Rn(e,n(e)):Hn(e);C(t,function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,U(`rev`))});function n(e){return function(t){return e.edge(t).weight}}}function Hn(e){var t=[],n={},r={};function i(a){w(r,a)||(r[a]=!0,n[a]=!0,C(e.outEdges(a),function(e){w(n,e.w)?t.push(e):i(e.w)}),delete n[a])}return C(e.nodes(),i),t}function Un(e){C(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}function K(e,t,n,r){var i;do i=U(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function Wn(e){var t=new y().setGraph(e.graph());return C(e.nodes(),function(n){t.setNode(n,e.node(n))}),C(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function Gn(e){var t=new y({multigraph:e.isMultigraph()}).setGraph(e.graph());return C(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),C(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function Kn(e,t){var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2;if(!i&&!a)throw Error(`Not possible to find intersection inside of the rectangle`);var c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=s*i/a,l=s):(i<0&&(o=-o),c=o,l=o*a/i),{x:n+c,y:r+l}}function q(e){var t=M(V(Xn(e)+1),function(){return[]});return C(e.nodes(),function(n){var r=e.node(n),i=r.rank;E(i)||(t[i][r.order]=n)}),t}function qn(e){var t=I(M(e.nodes(),function(t){return e.node(t).rank}));C(e.nodes(),function(n){var r=e.node(n);w(r,`rank`)&&(r.rank-=t)})}function Jn(e){var t=I(M(e.nodes(),function(t){return e.node(t).rank})),n=[];C(e.nodes(),function(r){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r)});var r=0,i=e.graph().nodeRankFactor;C(n,function(t,n){E(t)&&n%i!==0?--r:r&&C(t,function(t){e.node(t).rank+=r})})}function Yn(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),K(e,`border`,i,t)}function Xn(e){return F(M(e.nodes(),function(t){var n=e.node(t).rank;if(!E(n))return n}))}function Zn(e,t){var n={lhs:[],rhs:[]};return C(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e)}),n}function Qn(e,t){var n=Qe();try{return t()}finally{console.log(e+` time: `+(Qe()-n)+`ms`)}}function $n(e,t){return t()}function er(e){function t(n){var r=e.children(n),i=e.node(n);if(r.length&&C(r,t),w(i,`minRank`)){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,o=i.maxRank+1;a<o;++a)tr(e,`borderLeft`,`_bl`,n,i,a),tr(e,`borderRight`,`_br`,n,i,a)}}C(e.children(),t)}function tr(e,t,n,r,i,a){var o={width:0,height:0,rank:a,borderType:t},s=i[t][a-1],c=K(e,`border`,o,n);i[t][a]=c,e.setParent(c,r),s&&e.setEdge(s,c,{weight:1})}function nr(e){var t=e.graph().rankdir.toLowerCase();(t===`lr`||t===`rl`)&&ir(e)}function rr(e){var t=e.graph().rankdir.toLowerCase();(t===`bt`||t===`rl`)&&or(e),(t===`lr`||t===`rl`)&&(sr(e),ir(e))}function ir(e){C(e.nodes(),function(t){ar(e.node(t))}),C(e.edges(),function(t){ar(e.edge(t))})}function ar(e){var t=e.width;e.width=e.height,e.height=t}function or(e){C(e.nodes(),function(t){J(e.node(t))}),C(e.edges(),function(t){var n=e.edge(t);C(n.points,J),w(n,`y`)&&J(n)})}function J(e){e.y=-e.y}function sr(e){C(e.nodes(),function(t){Y(e.node(t))}),C(e.edges(),function(t){var n=e.edge(t);C(n.points,Y),w(n,`x`)&&Y(n)})}function Y(e){var t=e.x;e.x=e.y,e.y=t}function cr(e){e.graph().dummyChains=[],C(e.edges(),function(t){lr(e,t)})}function lr(e,t){var n=t.v,r=e.node(n).rank,i=t.w,a=e.node(i).rank,o=t.name,s=e.edge(t),c=s.labelRank;if(a!==r+1){e.removeEdge(t);var l,u,d;for(d=0,++r;r<a;++d,++r)s.points=[],u={width:0,height:0,edgeLabel:s,edgeObj:t,rank:r},l=K(e,`edge`,u,`_d`),r===c&&(u.width=s.width,u.height=s.height,u.dummy=`edge-label`,u.labelpos=s.labelpos),e.setEdge(n,l,{weight:s.weight},o),d===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,i,{weight:s.weight},o)}}function ur(e){C(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy===`edge-label`&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}function X(e){var t={};function n(r){var i=e.node(r);if(w(t,r))return i.rank;t[r]=!0;var a=I(M(e.outEdges(r),function(t){return n(t.w)-e.edge(t).minlen}));return(a===1/0||a==null)&&(a=0),i.rank=a}C(e.sources(),n)}function Z(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}function dr(e){var t=new y({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var i,a;fr(t,e)<r;)i=pr(t,e),a=t.hasNode(i.v)?Z(e,i):-Z(e,i),mr(t,e,a);return t}function fr(e,t){function n(r){C(t.nodeEdges(r),function(i){var a=i.v,o=r===a?i.w:a;!e.hasNode(o)&&!Z(t,i)&&(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})}return C(e.nodes(),n),e.nodeCount()}function pr(e,t){return L(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return Z(t,n)})}function mr(e,t,n){C(e.nodes(),function(e){t.node(e).rank+=n})}var hr=p(1),gr=p(1);_r.CycleException=Q;function _r(e){var t={},n={},r=[];function i(a){if(w(n,a))throw new Q;w(t,a)||(n[a]=!0,t[a]=!0,C(e.predecessors(a),i),delete n[a],r.push(a))}if(C(e.sinks(),i),En(t)!==e.nodeCount())throw new Q;return r}function Q(){}Q.prototype=Error();function vr(e,t,n){g(t)||(t=[t]);var r=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],a={};return C(t,function(t){if(!e.hasNode(t))throw Error(`Graph does not have node: `+t);yr(e,t,n===`post`,a,r,i)}),i}function yr(e,t,n,r,i,a){w(r,t)||(r[t]=!0,n||a.push(t),C(i(t),function(t){yr(e,t,n,r,i,a)}),n&&a.push(t))}function br(e,t){return vr(e,t,`post`)}function xr(e,t){return vr(e,t,`pre`)}$.initLowLimValues=Tr,$.initCutValues=Sr,$.calcCutValue=wr,$.leaveEdge=Dr,$.enterEdge=Or,$.exchangeEdges=kr;function $(e){e=Wn(e),X(e);var t=dr(e);Tr(t),Sr(t,e);for(var n,r;n=Dr(t);)r=Or(t,e,n),kr(t,e,n,r)}function Sr(e,t){var n=br(e,e.nodes());n=n.slice(0,n.length-1),C(n,function(n){Cr(e,t,n)})}function Cr(e,t,n){var r=e.node(n),i=r.parent;e.edge(n,i).cutvalue=wr(e,t,n)}function wr(e,t,n){var r=e.node(n),i=r.parent,a=!0,o=t.edge(n,i),s=0;return o||(a=!1,o=t.edge(i,n)),s=o.weight,C(t.nodeEdges(n),function(r){var o=r.v===n,c=o?r.w:r.v;if(c!==i){var l=o===a,u=t.edge(r).weight;if(s+=l?u:-u,jr(e,n,c)){var d=e.edge(n,c).cutvalue;s+=l?-d:d}}}),s}function Tr(e,t){arguments.length<2&&(t=e.nodes()[0]),Er(e,{},1,t)}function Er(e,t,n,r,i){var a=n,o=e.node(r);return t[r]=!0,C(e.neighbors(r),function(i){w(t,i)||(n=Er(e,t,n,i,r))}),o.low=a,o.lim=n++,i?o.parent=i:delete o.parent,n}function Dr(e){return ut(e.edges(),function(t){return e.edge(t).cutvalue<0})}function Or(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var a=e.node(r),o=e.node(i),s=a,c=!1;a.lim>o.lim&&(s=o,c=!0);var l=S(t.edges(),function(t){return c===Mr(e,e.node(t.v),s)&&c!==Mr(e,e.node(t.w),s)});return L(l,function(e){return Z(t,e)})}function kr(e,t,n,r){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),Tr(e),Sr(e,t),Ar(e,t)}function Ar(e,t){var n=ut(e.nodes(),function(e){return!t.node(e).parent}),r=xr(e,n);r=r.slice(1),C(r,function(n){var r=e.node(n).parent,i=t.edge(n,r),a=!1;i||(i=t.edge(r,n),a=!0),t.node(n).rank=t.node(r).rank+(a?i.minlen:-i.minlen)})}function jr(e,t,n){return e.hasEdge(t,n)}function Mr(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}function Nr(e){switch(e.graph().ranker){case`network-simplex`:Ir(e);break;case`tight-tree`:Fr(e);break;case`longest-path`:Pr(e);break;default:Ir(e)}}var Pr=X;function Fr(e){X(e),dr(e)}function Ir(e){$(e)}function Lr(e){var t=K(e,`root`,{},`_root`),n=zr(e),r=F(O(n))-1,i=2*r+1;e.graph().nestingRoot=t,C(e.edges(),function(t){e.edge(t).minlen*=i});var a=Br(e)+1;C(e.children(),function(o){Rr(e,t,i,a,r,n,o)}),e.graph().nodeRankFactor=i}function Rr(e,t,n,r,i,a,o){var s=e.children(o);if(!s.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:n});return}var c=Yn(e,`_bt`),l=Yn(e,`_bb`),u=e.node(o);e.setParent(c,o),u.borderTop=c,e.setParent(l,o),u.borderBottom=l,C(s,function(s){Rr(e,t,n,r,i,a,s);var u=e.node(s),d=u.borderTop?u.borderTop:s,f=u.borderBottom?u.borderBottom:s,p=u.borderTop?r:2*r,m=d===f?i-a[o]+1:1;e.setEdge(c,d,{weight:p,minlen:m,nestingEdge:!0}),e.setEdge(f,l,{weight:p,minlen:m,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+a[o]})}function zr(e){var t={};function n(r,i){var a=e.children(r);a&&a.length&&C(a,function(e){n(e,i+1)}),t[r]=i}return C(e.children(),function(e){n(e,1)}),t}function Br(e){return D(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function Vr(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,C(e.edges(),function(t){var n=e.edge(t);n.nestingEdge&&e.removeEdge(t)})}function Hr(e,t,n){var r={},i;C(n,function(n){for(var a=e.parent(n),o,s;a;){if(o=e.parent(a),o?(s=r[o],r[o]=a):(s=i,i=a),s&&s!==a){t.setEdge(s,a);return}a=o}})}function Ur(e,t,n){var r=Wr(e),i=new y({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(t){return e.node(t)});return C(e.nodes(),function(a){var o=e.node(a),s=e.parent(a);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(a),i.setParent(a,s||r),C(e[n](a),function(t){var n=t.v===a?t.w:t.v,r=i.edge(n,a),o=E(r)?0:r.weight;i.setEdge(n,a,{weight:e.edge(t).weight+o})}),w(o,`minRank`)&&i.setNode(a,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function Wr(e){for(var t;e.hasNode(t=U(`_root`)););return t}function Gr(e,t){for(var n=0,r=1;r<t.length;++r)n+=Kr(e,t[r-1],t[r]);return n}function Kr(e,t,n){for(var r=Nn(n,M(n,function(e,t){return t})),i=A(M(t,function(t){return H(M(e.outEdges(t),function(t){return{pos:r[t.w],weight:e.edge(t).weight}}),`pos`)})),a=1;a<n.length;)a<<=1;var o=2*a-1;--a;var s=M(Array(o),function(){return 0}),c=0;return C(i.forEach(function(e){var t=e.pos+a;s[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=s[t+1]),t=t-1>>1,s[t]+=e.weight;c+=e.weight*n})),c}function qr(e){var t={},n=S(e.nodes(),function(t){return!e.children(t).length}),r=F(M(n,function(t){return e.node(t).rank})),i=M(V(r+1),function(){return[]});function a(n){if(!w(t,n)){t[n]=!0;var r=e.node(n);i[r.rank].push(n),C(e.successors(n),a)}}var o=H(n,function(t){return e.node(t).rank});return C(o,a),i}function Jr(e,t){return M(t,function(t){var n=e.inEdges(t);if(n.length){var r=D(n,function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}else return{v:t}})}function Yr(e,t){var n={};C(e,function(e,t){var r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};E(e.barycenter)||(r.barycenter=e.barycenter,r.weight=e.weight)}),C(t.edges(),function(e){var t=n[e.v],r=n[e.w];!E(t)&&!E(r)&&(r.indegree++,t.out.push(n[e.w]))});var r=S(n,function(e){return!e.indegree});return Xr(r)}function Xr(e){var t=[];function n(e){return function(t){t.merged||(E(t.barycenter)||E(e.barycenter)||t.barycenter>=e.barycenter)&&Zr(e,t)}}function r(t){return function(n){n.in.push(t),--n.indegree===0&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),C(i.in.reverse(),n(i)),C(i.out,r(i))}return M(S(t,function(e){return!e.merged}),function(e){return B(e,[`vs`,`i`,`barycenter`,`weight`])})}function Zr(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}function Qr(e,t){var n=Zn(e,function(e){return w(e,`barycenter`)}),r=n.lhs,i=H(n.rhs,function(e){return-e.i}),a=[],o=0,s=0,c=0;r.sort(ei(!!t)),c=$r(a,i,c),C(r,function(e){c+=e.vs.length,a.push(e.vs),o+=e.barycenter*e.weight,s+=e.weight,c=$r(a,i,c)});var l={vs:A(a)};return s&&(l.barycenter=o/s,l.weight=s),l}function $r(e,t,n){for(var r;t.length&&(r=j(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function ei(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}function ti(e,t,n,r){var i=e.children(t),a=e.node(t),o=a?a.borderLeft:void 0,s=a?a.borderRight:void 0,c={};o&&(i=S(i,function(e){return e!==o&&e!==s}));var l=Jr(e,i);C(l,function(t){if(e.children(t.v).length){var i=ti(e,t.v,n,r);c[t.v]=i,w(i,`barycenter`)&&ri(t,i)}});var u=Yr(l,n);ni(u,c);var d=Qr(u,r);if(o&&(d.vs=A([o,d.vs,s]),e.predecessors(o).length)){var f=e.node(e.predecessors(o)[0]),p=e.node(e.predecessors(s)[0]);w(d,`barycenter`)||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+f.order+p.order)/(d.weight+2),d.weight+=2}return d}function ni(e,t){C(e,function(e){e.vs=A(e.vs.map(function(e){return t[e]?t[e].vs:e}))})}function ri(e,t){E(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}function ii(e){var t=Xn(e),n=ai(e,V(1,t+1),`inEdges`),r=ai(e,V(t-1,-1,-1),`outEdges`),i=qr(e);si(e,i);for(var a=1/0,o,s=0,c=0;c<4;++s,++c){oi(s%2?n:r,s%4>=2),i=q(e);var l=Gr(e,i);l<a&&(c=0,o=Xe(i),a=l)}si(e,o)}function ai(e,t,n){return M(t,function(t){return Ur(e,t,n)})}function oi(e,t){var n=new y;C(e,function(e){var r=e.graph().root,i=ti(e,r,n,t);C(i.vs,function(t,n){e.node(t).order=n}),Hr(e,n,i.vs)})}function si(e,t){C(t,function(t){C(t,function(t,n){e.node(t).order=n})})}function ci(e){var t=ui(e);C(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,a=li(e,t,i.v,i.w),o=a.path,s=a.lca,c=0,l=o[c],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(l=o[c])!==s&&e.node(l).maxRank<r.rank;)c++;l===s&&(u=!1)}if(!u){for(;c<o.length-1&&e.node(l=o[c+1]).minRank<=r.rank;)c++;l=o[c]}e.setParent(n,l),n=e.successors(n)[0]}})}function li(e,t,n,r){var i=[],a=[],o=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim),c,l;c=n;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||s>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)a.push(c);return{path:i.concat(a.reverse()),lca:l}}function ui(e){var t={},n=0;function r(i){var a=n;C(e.children(i),r),t[i]={low:a,lim:n++}}return C(e.children(),r),t}function di(e,t){var n={};function r(t,r){var i=0,a=0,o=t.length,s=j(r);return C(r,function(t,c){var l=pi(e,t),u=l?e.node(l).order:o;(l||t===s)&&(C(r.slice(a,c+1),function(t){C(e.predecessors(t),function(r){var a=e.node(r),o=a.order;(o<i||u<o)&&!(a.dummy&&e.node(t).dummy)&&mi(n,r,t)})}),a=c+1,i=u)}),r}return D(t,r),n}function fi(e,t){var n={};function r(t,r,i,a,o){var s;C(V(r,i),function(r){s=t[r],e.node(s).dummy&&C(e.predecessors(s),function(t){var r=e.node(t);r.dummy&&(r.order<a||r.order>o)&&mi(n,t,s)})})}function i(t,n){var i=-1,a,o=0;return C(n,function(s,c){if(e.node(s).dummy===`border`){var l=e.predecessors(s);l.length&&(a=e.node(l[0]).order,r(n,o,c,i,a),o=c,i=a)}r(n,o,n.length,a,t.length)}),n}return D(t,i),n}function pi(e,t){if(e.node(t).dummy)return ut(e.predecessors(t),function(t){return e.node(t).dummy})}function mi(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function hi(e,t,n){if(t>n){var r=t;t=n,n=r}return w(e[t],n)}function gi(e,t,n,r){var i={},a={},o={};return C(t,function(e){C(e,function(e,t){i[e]=e,a[e]=e,o[e]=t})}),C(t,function(e){var t=-1;C(e,function(e){var s=r(e);if(s.length){s=H(s,function(e){return o[e]});for(var c=(s.length-1)/2,l=Math.floor(c),u=Math.ceil(c);l<=u;++l){var d=s[l];a[e]===e&&t<o[d]&&!hi(n,e,d)&&(a[d]=e,a[e]=i[e]=i[d],t=o[d])}}})}),{root:i,align:a}}function _i(e,t,n,r,i){var a={},o=vi(e,t,n,i),s=i?`borderLeft`:`borderRight`;function c(e,t){for(var n=o.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}function l(e){a[e]=o.inEdges(e).reduce(function(e,t){return Math.max(e,a[t.v]+o.edge(t))},0)}function u(t){var n=o.outEdges(t).reduce(function(e,t){return Math.min(e,a[t.w]-o.edge(t))},1/0),r=e.node(t);n!==1/0&&r.borderType!==s&&(a[t]=Math.max(a[t],n))}return c(l,o.predecessors.bind(o)),c(u,o.successors.bind(o)),C(r,function(e){a[e]=a[n[e]]}),a}function vi(e,t,n,r){var i=new y,a=e.graph(),o=Ci(a.nodesep,a.edgesep,r);return C(t,function(t){var r;C(t,function(t){var a=n[t];if(i.setNode(a),r){var s=n[r],c=i.edge(s,a);i.setEdge(s,a,Math.max(o(e,t,r),c||0))}r=t})}),i}function yi(e,t){return L(O(t),function(t){var n=-1/0,r=1/0;return ht(t,function(t,i){var a=wi(e,i)/2;n=Math.max(t+a,n),r=Math.min(t-a,r)}),n-r})}function bi(e,t){var n=O(t),r=I(n),i=F(n);C([`u`,`d`],function(n){C([`l`,`r`],function(a){var o=n+a,s=e[o],c;if(s!==t){var l=O(s);c=a===`l`?r-I(l):i-F(l),c&&(e[o]=N(s,function(e){return e+c}))}})})}function xi(e,t){return N(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=H(M(e,r));return(i[1]+i[2])/2})}function Si(e){var t=q(e),n=v(di(e,t),fi(e,t)),r={},i;C([`u`,`d`],function(a){i=a===`u`?t:O(t).reverse(),C([`l`,`r`],function(t){t===`r`&&(i=M(i,function(e){return O(e).reverse()}));var o=(a===`u`?e.predecessors:e.successors).bind(e),s=gi(e,i,n,o),c=_i(e,i,s.root,s.align,t===`r`);t===`r`&&(c=N(c,function(e){return-e})),r[a+t]=c})});var a=yi(e,r);return bi(r,a),xi(r,e.graph().align)}function Ci(e,t,n){return function(r,i,a){var o=r.node(i),s=r.node(a),c=0,l;if(c+=o.width/2,w(o,`labelpos`))switch(o.labelpos.toLowerCase()){case`l`:l=-o.width/2;break;case`r`:l=o.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(o.dummy?t:e)/2,c+=(s.dummy?t:e)/2,c+=s.width/2,w(s,`labelpos`))switch(s.labelpos.toLowerCase()){case`l`:l=s.width/2;break;case`r`:l=-s.width/2;break}return l&&(c+=n?l:-l),l=0,c}}function wi(e,t){return e.node(t).width}function Ti(e){e=Gn(e),Ei(e),_t(Si(e),function(t,n){e.node(n).x=t})}function Ei(e){var t=q(e),n=e.graph().ranksep,r=0;C(t,function(t){var i=F(M(t,function(t){return e.node(t).height}));C(t,function(t){e.node(t).y=r+i/2}),r+=i+n})}function Di(e,t){var n=t&&t.debugTiming?Qn:$n;n(`layout`,function(){var t=n(`  buildLayoutGraph`,function(){return Ri(e)});n(`  runLayout`,function(){Oi(t,n)}),n(`  updateInputGraph`,function(){ki(e,t)})})}function Oi(e,t){t(`    makeSpaceForEdgeLabels`,function(){zi(e)}),t(`    removeSelfEdges`,function(){Ji(e)}),t(`    acyclic`,function(){Vn(e)}),t(`    nestingGraph.run`,function(){Lr(e)}),t(`    rank`,function(){Nr(Gn(e))}),t(`    injectEdgeLabelProxies`,function(){Bi(e)}),t(`    removeEmptyRanks`,function(){Jn(e)}),t(`    nestingGraph.cleanup`,function(){Vr(e)}),t(`    normalizeRanks`,function(){qn(e)}),t(`    assignRankMinMax`,function(){Vi(e)}),t(`    removeEdgeLabelProxies`,function(){Hi(e)}),t(`    normalize.run`,function(){cr(e)}),t(`    parentDummyChains`,function(){ci(e)}),t(`    addBorderSegments`,function(){er(e)}),t(`    order`,function(){ii(e)}),t(`    insertSelfEdges`,function(){Yi(e)}),t(`    adjustCoordinateSystem`,function(){nr(e)}),t(`    position`,function(){Ti(e)}),t(`    positionSelfEdges`,function(){Xi(e)}),t(`    removeBorderNodes`,function(){qi(e)}),t(`    normalize.undo`,function(){ur(e)}),t(`    fixupEdgeLabelCoords`,function(){Gi(e)}),t(`    undoCoordinateSystem`,function(){rr(e)}),t(`    translateGraph`,function(){Ui(e)}),t(`    assignNodeIntersects`,function(){Wi(e)}),t(`    reversePoints`,function(){Ki(e)}),t(`    acyclic.undo`,function(){Un(e)})}function ki(e,t){C(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),C(e.edges(),function(n){var r=e.edge(n),i=t.edge(n);r.points=i.points,w(i,`x`)&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var Ai=[`nodesep`,`edgesep`,`ranksep`,`marginx`,`marginy`],ji={ranksep:50,edgesep:20,nodesep:50,rankdir:`tb`},Mi=[`acyclicer`,`ranker`,`rankdir`,`align`],Ni=[`width`,`height`],Pi={width:0,height:0},Fi=[`minlen`,`weight`,`width`,`height`,`labeloffset`],Ii={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:`r`},Li=[`labelpos`];function Ri(e){var t=new y({multigraph:!0,compound:!0}),n=Qi(e.graph());return t.setGraph(v({},ji,Zi(n,Ai),B(n,Mi))),C(e.nodes(),function(n){var r=Qi(e.node(n));t.setNode(n,nt(Zi(r,Ni),Pi)),t.setParent(n,e.parent(n))}),C(e.edges(),function(n){var r=Qi(e.edge(n));t.setEdge(n,v({},Ii,Zi(r,Fi),B(r,Li)))}),t}function zi(e){var t=e.graph();t.ranksep/=2,C(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!==`c`&&(t.rankdir===`TB`||t.rankdir===`BT`?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function Bi(e){C(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w),a={rank:(i.rank-r.rank)/2+r.rank,e:t};K(e,`edge-proxy`,a,`_ep`)}})}function Vi(e){var t=0;C(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=F(t,r.maxRank))}),e.graph().maxRank=t}function Hi(e){C(e.nodes(),function(t){var n=e.node(t);n.dummy===`edge-proxy`&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function Ui(e){var t=1/0,n=0,r=1/0,i=0,a=e.graph(),o=a.marginx||0,s=a.marginy||0;function c(e){var a=e.x,o=e.y,s=e.width,c=e.height;t=Math.min(t,a-s/2),n=Math.max(n,a+s/2),r=Math.min(r,o-c/2),i=Math.max(i,o+c/2)}C(e.nodes(),function(t){c(e.node(t))}),C(e.edges(),function(t){var n=e.edge(t);w(n,`x`)&&c(n)}),t-=o,r-=s,C(e.nodes(),function(n){var i=e.node(n);i.x-=t,i.y-=r}),C(e.edges(),function(n){var i=e.edge(n);C(i.points,function(e){e.x-=t,e.y-=r}),w(i,`x`)&&(i.x-=t),w(i,`y`)&&(i.y-=r)}),a.width=n-t+o,a.height=i-r+s}function Wi(e){C(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),a,o;n.points?(a=n.points[0],o=n.points[n.points.length-1]):(n.points=[],a=i,o=r),n.points.unshift(Kn(r,a)),n.points.push(Kn(i,o))})}function Gi(e){C(e.edges(),function(t){var n=e.edge(t);if(w(n,`x`))switch((n.labelpos===`l`||n.labelpos===`r`)&&(n.width-=n.labeloffset),n.labelpos){case`l`:n.x-=n.width/2+n.labeloffset;break;case`r`:n.x+=n.width/2+n.labeloffset;break}})}function Ki(e){C(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function qi(e){C(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),a=e.node(j(n.borderLeft)),o=e.node(j(n.borderRight));n.width=Math.abs(o.x-a.x),n.height=Math.abs(i.y-r.y),n.x=a.x+n.width/2,n.y=r.y+n.height/2}}),C(e.nodes(),function(t){e.node(t).dummy===`border`&&e.removeNode(t)})}function Ji(e){C(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||=[],n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function Yi(e){var t=q(e);C(t,function(t){var n=0;C(t,function(t,r){var i=e.node(t);i.order=r+n,C(i.selfEdges,function(t){K(e,`selfedge`,{width:t.label.width,height:t.label.height,rank:i.rank,order:r+ ++n,e:t.e,label:t.label},`_se`)}),delete i.selfEdges})})}function Xi(e){C(e.nodes(),function(t){var n=e.node(t);if(n.dummy===`selfedge`){var r=e.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}})}function Zi(e,t){return N(B(e,t),Number)}function Qi(e){var t={};return C(e,function(e,n){t[n.toLowerCase()]=e}),t}export{nt as defaults_default,Di as layout,M as map_default,B as pick_default,V as range_default,U as uniqueId_default};