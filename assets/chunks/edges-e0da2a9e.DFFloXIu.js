import{basis_default as e,decodeEntities as t,evaluate as n,getConfig as r,log$1 as i,sanitizeText$2 as a,select_default as o,utils as s}from"./mermaid-b5860b54.CzyV0eq4.js";import{line_default as c}from"./line.DTlckFuN.js";import{createText as l}from"./createText-2e5e7dd3.DgWvnF3i.js";const u=(e,t,n,r)=>{t.forEach(t=>{b[t](e,n,r)})},d=(e,t,n)=>{i.trace(`Making markers for `,n),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-extensionStart`).attr(`class`,`marker extension `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,7 L18,13 V 1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-extensionEnd`).attr(`class`,`marker extension `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 V 13 L18,7 Z`)},f=(e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-compositionStart`).attr(`class`,`marker composition `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-compositionEnd`).attr(`class`,`marker composition `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`)},p=(e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-aggregationStart`).attr(`class`,`marker aggregation `+t).attr(`refX`,18).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-aggregationEnd`).attr(`class`,`marker aggregation `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`)},m=(e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-dependencyStart`).attr(`class`,`marker dependency `+t).attr(`refX`,6).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 5,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-dependencyEnd`).attr(`class`,`marker dependency `+t).attr(`refX`,13).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L14,7 L9,1 Z`)},h=(e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-lollipopStart`).attr(`class`,`marker lollipop `+t).attr(`refX`,13).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`circle`).attr(`stroke`,`black`).attr(`fill`,`transparent`).attr(`cx`,7).attr(`cy`,7).attr(`r`,6),e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-lollipopEnd`).attr(`class`,`marker lollipop `+t).attr(`refX`,1).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`circle`).attr(`stroke`,`black`).attr(`fill`,`transparent`).attr(`cx`,7).attr(`cy`,7).attr(`r`,6)},g=(e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-pointEnd`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,6).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,12).attr(`markerHeight`,12).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 z`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-pointStart`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,4.5).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,12).attr(`markerHeight`,12).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 5 L 10 10 L 10 0 z`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`)},_=(e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-circleEnd`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,11).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`circle`).attr(`cx`,`5`).attr(`cy`,`5`).attr(`r`,`5`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-circleStart`).attr(`class`,`marker `+t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,-1).attr(`refY`,5).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`circle`).attr(`cx`,`5`).attr(`cy`,`5`).attr(`r`,`5`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`)},v=(e,t,n)=>{e.append(`marker`).attr(`id`,n+`_`+t+`-crossEnd`).attr(`class`,`marker cross `+t).attr(`viewBox`,`0 0 11 11`).attr(`refX`,12).attr(`refY`,5.2).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 l 9,9 M 10,1 l -9,9`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,2).style(`stroke-dasharray`,`1,0`),e.append(`marker`).attr(`id`,n+`_`+t+`-crossStart`).attr(`class`,`marker cross `+t).attr(`viewBox`,`0 0 11 11`).attr(`refX`,-1).attr(`refY`,5.2).attr(`markerUnits`,`userSpaceOnUse`).attr(`markerWidth`,11).attr(`markerHeight`,11).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 1,1 l 9,9 M 10,1 l -9,9`).attr(`class`,`arrowMarkerPath`).style(`stroke-width`,2).style(`stroke-dasharray`,`1,0`)},y=(e,t,n)=>{e.append(`defs`).append(`marker`).attr(`id`,n+`_`+t+`-barbEnd`).attr(`refX`,19).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,14).attr(`markerUnits`,`strokeWidth`).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 19,7 L9,13 L14,7 L9,1 Z`)},b={extension:d,composition:f,aggregation:p,dependency:m,lollipop:h,point:g,circle:_,cross:v,barb:y},x=u;function S(e,t){t&&e.attr(`style`,t)}function C(e){let t=o(document.createElementNS(`http://www.w3.org/2000/svg`,`foreignObject`)),n=t.append(`xhtml:div`),r=e.label,i=e.isNode?`nodeLabel`:`edgeLabel`;return n.html(`<span class="`+i+`" `+(e.labelStyle?`style="`+e.labelStyle+`"`:``)+`>`+r+`</span>`),S(n,e.labelStyle),n.style(`display`,`inline-block`),n.style(`white-space`,`nowrap`),n.attr(`xmlns`,`http://www.w3.org/1999/xhtml`),t.node()}const w=(e,a,o,s)=>{let c=e||``;if(typeof c==`object`&&(c=c[0]),n(r().flowchart.htmlLabels)){c=c.replace(/\\n|\n/g,`<br />`),i.debug(`vertexText`+c);let e={isNode:s,label:t(c).replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(`:`,` `)}'></i>`),labelStyle:a.replace(`fill:`,`color:`)},n=C(e);return n}else{let e=document.createElementNS(`http://www.w3.org/2000/svg`,`text`);e.setAttribute(`style`,a.replace(`color:`,`fill:`));let t=[];t=typeof c==`string`?c.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(c)?c:[];for(let n of t){let t=document.createElementNS(`http://www.w3.org/2000/svg`,`tspan`);t.setAttributeNS(`http://www.w3.org/XML/1998/namespace`,`xml:space`,`preserve`),t.setAttribute(`dy`,`1em`),t.setAttribute(`x`,`0`),o?t.setAttribute(`class`,`title-row`):t.setAttribute(`class`,`row`),t.textContent=n.trim(),e.appendChild(t)}return e}},T=w,E=async(e,i,s,c)=>{let u,d=i.useHtmlLabels||n(r().flowchart.htmlLabels);u=s||`node default`;let f=e.insert(`g`).attr(`class`,u).attr(`id`,i.domId||i.id),p=f.insert(`g`).attr(`class`,`label`).attr(`style`,i.labelStyle),m;m=i.labelText===void 0?``:typeof i.labelText==`string`?i.labelText:i.labelText[0];let h=p.node(),g;g=i.labelType===`markdown`?l(p,a(t(m),r()),{useHtmlLabels:d,width:i.width||r().flowchart.wrappingWidth,classes:`markdown-node-label`}):h.appendChild(T(a(t(m),r()),i.labelStyle,!1,c));let _=g.getBBox(),v=i.padding/2;if(n(r().flowchart.htmlLabels)){let e=g.children[0],t=o(g),n=e.getElementsByTagName(`img`);if(n){let e=m.replace(/<img[^>]*>/g,``).trim()===``;await Promise.all([...n].map(t=>new Promise(n=>{function i(){if(t.style.display=`flex`,t.style.flexDirection=`column`,e){let e=r().fontSize?r().fontSize:window.getComputedStyle(document.body).fontSize,n=5,i=parseInt(e,10)*n+`px`;t.style.minWidth=i,t.style.maxWidth=i}else t.style.width=`100%`;n(t)}setTimeout(()=>{t.complete&&i()}),t.addEventListener(`error`,i),t.addEventListener(`load`,i)})))}_=e.getBoundingClientRect(),t.attr(`width`,_.width),t.attr(`height`,_.height)}return d?p.attr(`transform`,`translate(`+-_.width/2+`, `+-_.height/2+`)`):p.attr(`transform`,`translate(0, `+-_.height/2+`)`),i.centerLabel&&p.attr(`transform`,`translate(`+-_.width/2+`, `+-_.height/2+`)`),p.insert(`rect`,`:first-child`),{shapeSvg:f,bbox:_,halfPadding:v,label:p}},D=(e,t)=>{let n=t.node().getBBox();e.width=n.width,e.height=n.height};function O(e,t,n,r){return e.insert(`polygon`,`:first-child`).attr(`points`,r.map(function(e){return e.x+`,`+e.y}).join(` `)).attr(`class`,`label-container`).attr(`transform`,`translate(`+-t/2+`,`+n/2+`)`)}function ee(e,t){return e.intersect(t)}function k(e,t,n,r){var i=e.x,a=e.y,o=i-r.x,s=a-r.y,c=Math.sqrt(t*t*s*s+n*n*o*o),l=Math.abs(t*n*o/c);r.x<i&&(l=-l);var u=Math.abs(t*n*s/c);return r.y<a&&(u=-u),{x:i+l,y:a+u}}function te(e,t,n){return k(e,t,t,n)}function ne(e,t,n,r){var i,a,o,s,c,l,u,d,f,p,m,h,g,_,v;if(i=t.y-e.y,o=e.x-t.x,c=t.x*e.y-e.x*t.y,f=i*n.x+o*n.y+c,p=i*r.x+o*r.y+c,!(f!==0&&p!==0&&A(f,p))&&(a=r.y-n.y,s=n.x-r.x,l=r.x*n.y-n.x*r.y,u=a*e.x+s*e.y+l,d=a*t.x+s*t.y+l,!(u!==0&&d!==0&&A(u,d))&&(m=i*s-a*o,m!==0)))return h=Math.abs(m/2),g=o*l-s*c,_=g<0?(g-h)/m:(g+h)/m,g=a*c-i*l,v=g<0?(g-h)/m:(g+h)/m,{x:_,y:v}}function A(e,t){return e*t>0}function re(e,t,n){var r=e.x,i=e.y,a=[],o=1/0,s=1/0;typeof t.forEach==`function`?t.forEach(function(e){o=Math.min(o,e.x),s=Math.min(s,e.y)}):(o=Math.min(o,t.x),s=Math.min(s,t.y));for(var c=r-e.width/2-o,l=i-e.height/2-s,u=0;u<t.length;u++){var d=t[u],f=t[u<t.length-1?u+1:0],p=ne(e,n,{x:c+d.x,y:l+d.y},{x:c+f.x,y:l+f.y});p&&a.push(p)}return a.length?(a.length>1&&a.sort(function(e,t){var r=e.x-n.x,i=e.y-n.y,a=Math.sqrt(r*r+i*i),o=t.x-n.x,s=t.y-n.y,c=Math.sqrt(o*o+s*s);return a<c?-1:a===c?0:1}),a[0]):e}const ie=(e,t)=>{var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2,c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=a===0?0:s*i/a,l=s):(i<0&&(o=-o),c=o,l=i===0?0:o*a/i),{x:n+c,y:r+l}},j=ie,M={node:ee,circle:te,ellipse:k,polygon:re,rect:j},ae=async(e,t)=>{let n=t.useHtmlLabels||r().flowchart.htmlLabels;n||(t.centerLabel=!0);let{shapeSvg:a,bbox:o,halfPadding:s}=await E(e,t,`node `+t.classes,!0);i.info(`Classes = `,t.classes);let c=a.insert(`rect`,`:first-child`);return c.attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,-o.width/2-s).attr(`y`,-o.height/2-s).attr(`width`,o.width+t.padding).attr(`height`,o.height+t.padding),D(t,c),t.intersect=function(e){return M.rect(t,e)},a},oe=ae,se=e=>{let t=new Set;for(let n of e)switch(n){case`x`:t.add(`right`),t.add(`left`);break;case`y`:t.add(`up`),t.add(`down`);break;default:t.add(n);break}return t},ce=(e,t,n)=>{let r=se(e),i=2,a=t.height+2*n.padding,o=a/i,s=t.width+2*o+n.padding,c=n.padding/2;return r.has(`right`)&&r.has(`left`)&&r.has(`up`)&&r.has(`down`)?[{x:0,y:0},{x:o,y:0},{x:s/2,y:2*c},{x:s-o,y:0},{x:s,y:0},{x:s,y:-a/3},{x:s+2*c,y:-a/2},{x:s,y:-2*a/3},{x:s,y:-a},{x:s-o,y:-a},{x:s/2,y:-a-2*c},{x:o,y:-a},{x:0,y:-a},{x:0,y:-2*a/3},{x:-2*c,y:-a/2},{x:0,y:-a/3}]:r.has(`right`)&&r.has(`left`)&&r.has(`up`)?[{x:o,y:0},{x:s-o,y:0},{x:s,y:-a/2},{x:s-o,y:-a},{x:o,y:-a},{x:0,y:-a/2}]:r.has(`right`)&&r.has(`left`)&&r.has(`down`)?[{x:0,y:0},{x:o,y:-a},{x:s-o,y:-a},{x:s,y:0}]:r.has(`right`)&&r.has(`up`)&&r.has(`down`)?[{x:0,y:0},{x:s,y:-o},{x:s,y:-a+o},{x:0,y:-a}]:r.has(`left`)&&r.has(`up`)&&r.has(`down`)?[{x:s,y:0},{x:0,y:-o},{x:0,y:-a+o},{x:s,y:-a}]:r.has(`right`)&&r.has(`left`)?[{x:o,y:0},{x:o,y:-c},{x:s-o,y:-c},{x:s-o,y:0},{x:s,y:-a/2},{x:s-o,y:-a},{x:s-o,y:-a+c},{x:o,y:-a+c},{x:o,y:-a},{x:0,y:-a/2}]:r.has(`up`)&&r.has(`down`)?[{x:s/2,y:0},{x:0,y:-c},{x:o,y:-c},{x:o,y:-a+c},{x:0,y:-a+c},{x:s/2,y:-a},{x:s,y:-a+c},{x:s-o,y:-a+c},{x:s-o,y:-c},{x:s,y:-c}]:r.has(`right`)&&r.has(`up`)?[{x:0,y:0},{x:s,y:-o},{x:0,y:-a}]:r.has(`right`)&&r.has(`down`)?[{x:0,y:0},{x:s,y:0},{x:0,y:-a}]:r.has(`left`)&&r.has(`up`)?[{x:s,y:0},{x:0,y:-o},{x:s,y:-a}]:r.has(`left`)&&r.has(`down`)?[{x:s,y:0},{x:0,y:0},{x:s,y:-a}]:r.has(`right`)?[{x:o,y:-c},{x:o,y:-c},{x:s-o,y:-c},{x:s-o,y:0},{x:s,y:-a/2},{x:s-o,y:-a},{x:s-o,y:-a+c},{x:o,y:-a+c},{x:o,y:-a+c}]:r.has(`left`)?[{x:o,y:0},{x:o,y:-c},{x:s-o,y:-c},{x:s-o,y:-a+c},{x:o,y:-a+c},{x:o,y:-a},{x:0,y:-a/2}]:r.has(`up`)?[{x:o,y:-c},{x:o,y:-a+c},{x:0,y:-a+c},{x:s/2,y:-a},{x:s,y:-a+c},{x:s-o,y:-a+c},{x:s-o,y:-c}]:r.has(`down`)?[{x:s/2,y:0},{x:0,y:-c},{x:o,y:-c},{x:o,y:-a+c},{x:s-o,y:-a+c},{x:s-o,y:-c},{x:s,y:-c}]:[{x:0,y:0}]},N=e=>e?` `+e:``,P=(e,t)=>`${t||`node default`}${N(e.classes)} ${N(e.class)}`,F=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),a=r.width+t.padding,o=r.height+t.padding,s=a+o,c=[{x:s/2,y:0},{x:s,y:-s/2},{x:s/2,y:-s},{x:0,y:-s/2}];i.info(`Question main (Circle)`);let l=O(n,s,s,c);return l.attr(`style`,t.style),D(t,l),t.intersect=function(e){return i.warn(`Intersect called`),M.polygon(t,c,e)},n},le=(e,t)=>{let n=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),r=28,i=[{x:0,y:r/2},{x:r/2,y:0},{x:0,y:-r/2},{x:-r/2,y:0}],a=n.insert(`polygon`,`:first-child`).attr(`points`,i.map(function(e){return e.x+`,`+e.y}).join(` `));return a.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,28).attr(`height`,28),t.width=28,t.height=28,t.intersect=function(e){return M.circle(t,14,e)},n},ue=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=4,a=r.height+t.padding,o=a/i,s=r.width+2*o+t.padding,c=[{x:o,y:0},{x:s-o,y:0},{x:s,y:-a/2},{x:s-o,y:-a},{x:o,y:-a},{x:0,y:-a/2}],l=O(n,s,a,c);return l.attr(`style`,t.style),D(t,l),t.intersect=function(e){return M.polygon(t,c,e)},n},de=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,void 0,!0),i=2,a=r.height+2*t.padding,o=a/i,s=r.width+2*o+t.padding,c=ce(t.directions,r,t),l=O(n,s,a,c);return l.attr(`style`,t.style),D(t,l),t.intersect=function(e){return M.polygon(t,c,e)},n},fe=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:-a/2,y:0},{x:i,y:0},{x:i,y:-a},{x:-a/2,y:-a},{x:0,y:-a/2}],s=O(n,i,a,o);return s.attr(`style`,t.style),t.width=i+a,t.height=a,t.intersect=function(e){return M.polygon(t,o,e)},n},pe=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:-2*a/6,y:0},{x:i-a/6,y:0},{x:i+2*a/6,y:-a},{x:a/6,y:-a}],s=O(n,i,a,o);return s.attr(`style`,t.style),D(t,s),t.intersect=function(e){return M.polygon(t,o,e)},n},me=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:2*a/6,y:0},{x:i+a/6,y:0},{x:i-2*a/6,y:-a},{x:-a/6,y:-a}],s=O(n,i,a,o);return s.attr(`style`,t.style),D(t,s),t.intersect=function(e){return M.polygon(t,o,e)},n},he=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:-2*a/6,y:0},{x:i+2*a/6,y:0},{x:i-a/6,y:-a},{x:a/6,y:-a}],s=O(n,i,a,o);return s.attr(`style`,t.style),D(t,s),t.intersect=function(e){return M.polygon(t,o,e)},n},ge=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:a/6,y:0},{x:i-a/6,y:0},{x:i+2*a/6,y:-a},{x:-2*a/6,y:-a}],s=O(n,i,a,o);return s.attr(`style`,t.style),D(t,s),t.intersect=function(e){return M.polygon(t,o,e)},n},I=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:0,y:0},{x:i+a/2,y:0},{x:i,y:-a/2},{x:i+a/2,y:-a},{x:0,y:-a}],s=O(n,i,a,o);return s.attr(`style`,t.style),D(t,s),t.intersect=function(e){return M.polygon(t,o,e)},n},L=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=r.width+t.padding,a=i/2,o=a/(2.5+i/50),s=r.height+o+t.padding,c=`M 0,`+o+` a `+a+`,`+o+` 0,0,0 `+i+` 0 a `+a+`,`+o+` 0,0,0 `+-i+` 0 l 0,`+s+` a `+a+`,`+o+` 0,0,0 `+i+` 0 l 0,`+-s,l=n.attr(`label-offset-y`,o).insert(`path`,`:first-child`).attr(`style`,t.style).attr(`d`,c).attr(`transform`,`translate(`+-i/2+`,`+-(s/2+o)+`)`);return D(t,l),t.intersect=function(e){let n=M.rect(t,e),r=n.x-t.x;if(a!=0&&(Math.abs(r)<t.width/2||Math.abs(r)==t.width/2&&Math.abs(n.y-t.y)>t.height/2-o)){let i=o*o*(1-r*r/(a*a));i!=0&&(i=Math.sqrt(i)),i=o-i,e.y-t.y>0&&(i=-i),n.y+=i}return n},n},_e=async(e,t)=>{let{shapeSvg:n,bbox:r,halfPadding:a}=await E(e,t,`node `+t.classes+` `+t.class,!0),o=n.insert(`rect`,`:first-child`),s=t.positioned?t.width:r.width+t.padding,c=t.positioned?t.height:r.height+t.padding,l=t.positioned?-s/2:-r.width/2-a,u=t.positioned?-c/2:-r.height/2-a;if(o.attr(`class`,`basic label-container`).attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,l).attr(`y`,u).attr(`width`,s).attr(`height`,c),t.props){let e=new Set(Object.keys(t.props));t.props.borders&&(R(o,t.props.borders,s,c),e.delete(`borders`)),e.forEach(e=>{i.warn(`Unknown node property ${e}`)})}return D(t,o),t.intersect=function(e){return M.rect(t,e)},n},ve=async(e,t)=>{let{shapeSvg:n,bbox:r,halfPadding:a}=await E(e,t,`node `+t.classes,!0),o=n.insert(`rect`,`:first-child`),s=t.positioned?t.width:r.width+t.padding,c=t.positioned?t.height:r.height+t.padding,l=t.positioned?-s/2:-r.width/2-a,u=t.positioned?-c/2:-r.height/2-a;if(o.attr(`class`,`basic cluster composite label-container`).attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`x`,l).attr(`y`,u).attr(`width`,s).attr(`height`,c),t.props){let e=new Set(Object.keys(t.props));t.props.borders&&(R(o,t.props.borders,s,c),e.delete(`borders`)),e.forEach(e=>{i.warn(`Unknown node property ${e}`)})}return D(t,o),t.intersect=function(e){return M.rect(t,e)},n},ye=async(e,t)=>{let{shapeSvg:n}=await E(e,t,`label`,!0);i.trace(`Classes = `,t.class);let r=n.insert(`rect`,`:first-child`),a=0,o=0;if(r.attr(`width`,a).attr(`height`,o),n.attr(`class`,`label edgeLabel`),t.props){let e=new Set(Object.keys(t.props));t.props.borders&&(R(r,t.props.borders,a,o),e.delete(`borders`)),e.forEach(e=>{i.warn(`Unknown node property ${e}`)})}return D(t,r),t.intersect=function(e){return M.rect(t,e)},n};function R(e,t,n,r){let a=[],o=e=>{a.push(e,0)},s=e=>{a.push(0,e)};t.includes(`t`)?(i.debug(`add top border`),o(n)):s(n),t.includes(`r`)?(i.debug(`add right border`),o(r)):s(r),t.includes(`b`)?(i.debug(`add bottom border`),o(n)):s(n),t.includes(`l`)?(i.debug(`add left border`),o(r)):s(r),e.attr(`stroke-dasharray`,a.join(` `))}const be=(e,t)=>{let a;a=t.classes?`node `+t.classes:`node default`;let s=e.insert(`g`).attr(`class`,a).attr(`id`,t.domId||t.id),c=s.insert(`rect`,`:first-child`),l=s.insert(`line`),u=s.insert(`g`).attr(`class`,`label`),d=t.labelText.flat?t.labelText.flat():t.labelText,f=``;f=typeof d==`object`?d[0]:d,i.info(`Label text abc79`,f,d,typeof d==`object`);let p=u.node().appendChild(T(f,t.labelStyle,!0,!0)),m={width:0,height:0};if(n(r().flowchart.htmlLabels)){let e=p.children[0],t=o(p);m=e.getBoundingClientRect(),t.attr(`width`,m.width),t.attr(`height`,m.height)}i.info(`Text 2`,d);let h=d.slice(1,d.length),g=p.getBBox(),_=u.node().appendChild(T(h.join?h.join(`<br/>`):h,t.labelStyle,!0,!0));if(n(r().flowchart.htmlLabels)){let e=_.children[0],t=o(_);m=e.getBoundingClientRect(),t.attr(`width`,m.width),t.attr(`height`,m.height)}let v=t.padding/2;return o(_).attr(`transform`,`translate( `+(m.width>g.width?0:(g.width-m.width)/2)+`, `+(g.height+v+5)+`)`),o(p).attr(`transform`,`translate( `+(m.width<g.width?0:-(g.width-m.width)/2)+`, 0)`),m=u.node().getBBox(),u.attr(`transform`,`translate(`+-m.width/2+`, `+(-m.height/2-v+3)+`)`),c.attr(`class`,`outer title-state`).attr(`x`,-m.width/2-v).attr(`y`,-m.height/2-v).attr(`width`,m.width+t.padding).attr(`height`,m.height+t.padding),l.attr(`class`,`divider`).attr(`x1`,-m.width/2-v).attr(`x2`,m.width/2+v).attr(`y1`,-m.height/2-v+g.height+v).attr(`y2`,-m.height/2-v+g.height+v),D(t,c),t.intersect=function(e){return M.rect(t,e)},s},xe=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=r.height+t.padding,a=r.width+i/4+t.padding,o=n.insert(`rect`,`:first-child`).attr(`style`,t.style).attr(`rx`,i/2).attr(`ry`,i/2).attr(`x`,-a/2).attr(`y`,-i/2).attr(`width`,a).attr(`height`,i);return D(t,o),t.intersect=function(e){return M.rect(t,e)},n},Se=async(e,t)=>{let{shapeSvg:n,bbox:r,halfPadding:a}=await E(e,t,P(t,void 0),!0),o=n.insert(`circle`,`:first-child`);return o.attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`r`,r.width/2+a).attr(`width`,r.width+t.padding).attr(`height`,r.height+t.padding),i.info(`Circle main`),D(t,o),t.intersect=function(e){return i.info(`Circle intersect`,t,r.width/2+a,e),M.circle(t,r.width/2+a,e)},n},Ce=async(e,t)=>{let{shapeSvg:n,bbox:r,halfPadding:a}=await E(e,t,P(t,void 0),!0),o=5,s=n.insert(`g`,`:first-child`),c=s.insert(`circle`),l=s.insert(`circle`);return s.attr(`class`,t.class),c.attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`r`,r.width/2+a+o).attr(`width`,r.width+t.padding+o*2).attr(`height`,r.height+t.padding+o*2),l.attr(`style`,t.style).attr(`rx`,t.rx).attr(`ry`,t.ry).attr(`r`,r.width/2+a).attr(`width`,r.width+t.padding).attr(`height`,r.height+t.padding),i.info(`DoubleCircle main`),D(t,c),t.intersect=function(e){return i.info(`DoubleCircle intersect`,t,r.width/2+a+o,e),M.circle(t,r.width/2+a+o,e)},n},we=async(e,t)=>{let{shapeSvg:n,bbox:r}=await E(e,t,P(t,void 0),!0),i=r.width+t.padding,a=r.height+t.padding,o=[{x:0,y:0},{x:i,y:0},{x:i,y:-a},{x:0,y:-a},{x:0,y:0},{x:-8,y:0},{x:i+8,y:0},{x:i+8,y:-a},{x:-8,y:-a},{x:-8,y:0}],s=O(n,i,a,o);return s.attr(`style`,t.style),D(t,s),t.intersect=function(e){return M.polygon(t,o,e)},n},z=(e,t)=>{let n=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),r=n.insert(`circle`,`:first-child`);return r.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,14).attr(`height`,14),D(t,r),t.intersect=function(e){return M.circle(t,7,e)},n},B=(e,t,n)=>{let r=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),i=70,a=10;n===`LR`&&(i=10,a=70);let o=r.append(`rect`).attr(`x`,-1*i/2).attr(`y`,-1*a/2).attr(`width`,i).attr(`height`,a).attr(`class`,`fork-join`);return D(t,o),t.height+=t.padding/2,t.width+=t.padding/2,t.intersect=function(e){return M.rect(t,e)},r},Te=(e,t)=>{let n=e.insert(`g`).attr(`class`,`node default`).attr(`id`,t.domId||t.id),r=n.insert(`circle`,`:first-child`),i=n.insert(`circle`,`:first-child`);return i.attr(`class`,`state-start`).attr(`r`,7).attr(`width`,14).attr(`height`,14),r.attr(`class`,`state-end`).attr(`r`,5).attr(`width`,10).attr(`height`,10),D(t,i),t.intersect=function(e){return M.circle(t,7,e)},n},Ee=(e,t)=>{let i=t.padding/2,a=4,s=8,c;c=t.classes?`node `+t.classes:`node default`;let l=e.insert(`g`).attr(`class`,c).attr(`id`,t.domId||t.id),u=l.insert(`rect`,`:first-child`),d=l.insert(`line`),f=l.insert(`line`),p=0,m=a,h=l.insert(`g`).attr(`class`,`label`),g=0,_=t.classData.annotations&&t.classData.annotations[0],v=t.classData.annotations[0]?`«`+t.classData.annotations[0]+`»`:``,y=h.node().appendChild(T(v,t.labelStyle,!0,!0)),b=y.getBBox();if(n(r().flowchart.htmlLabels)){let e=y.children[0],t=o(y);b=e.getBoundingClientRect(),t.attr(`width`,b.width),t.attr(`height`,b.height)}t.classData.annotations[0]&&(m+=b.height+a,p+=b.width);let x=t.classData.label;t.classData.type!==void 0&&t.classData.type!==``&&(r().flowchart.htmlLabels?x+=`&lt;`+t.classData.type+`&gt;`:x+=`<`+t.classData.type+`>`);let S=h.node().appendChild(T(x,t.labelStyle,!0,!0));o(S).attr(`class`,`classTitle`);let C=S.getBBox();if(n(r().flowchart.htmlLabels)){let e=S.children[0],t=o(S);C=e.getBoundingClientRect(),t.attr(`width`,C.width),t.attr(`height`,C.height)}m+=C.height+a,C.width>p&&(p=C.width);let w=[];t.classData.members.forEach(e=>{let i=e.getDisplayDetails(),s=i.displayText;r().flowchart.htmlLabels&&(s=s.replace(/</g,`&lt;`).replace(/>/g,`&gt;`));let c=h.node().appendChild(T(s,i.cssStyle?i.cssStyle:t.labelStyle,!0,!0)),l=c.getBBox();if(n(r().flowchart.htmlLabels)){let e=c.children[0],t=o(c);l=e.getBoundingClientRect(),t.attr(`width`,l.width),t.attr(`height`,l.height)}l.width>p&&(p=l.width),m+=l.height+a,w.push(c)}),m+=s;let E=[];if(t.classData.methods.forEach(e=>{let i=e.getDisplayDetails(),s=i.displayText;r().flowchart.htmlLabels&&(s=s.replace(/</g,`&lt;`).replace(/>/g,`&gt;`));let c=h.node().appendChild(T(s,i.cssStyle?i.cssStyle:t.labelStyle,!0,!0)),l=c.getBBox();if(n(r().flowchart.htmlLabels)){let e=c.children[0],t=o(c);l=e.getBoundingClientRect(),t.attr(`width`,l.width),t.attr(`height`,l.height)}l.width>p&&(p=l.width),m+=l.height+a,E.push(c)}),m+=s,_){let e=(p-b.width)/2;o(y).attr(`transform`,`translate( `+(-1*p/2+e)+`, `+-1*m/2+`)`),g=b.height+a}let O=(p-C.width)/2;return o(S).attr(`transform`,`translate( `+(-1*p/2+O)+`, `+(-1*m/2+g)+`)`),g+=C.height+a,d.attr(`class`,`divider`).attr(`x1`,-p/2-i).attr(`x2`,p/2+i).attr(`y1`,-m/2-i+s+g).attr(`y2`,-m/2-i+s+g),g+=s,w.forEach(e=>{o(e).attr(`transform`,`translate( `+-p/2+`, `+(-1*m/2+g+s/2)+`)`);let t=e?.getBBox();g+=(t?.height??0)+a}),g+=s,f.attr(`class`,`divider`).attr(`x1`,-p/2-i).attr(`x2`,p/2+i).attr(`y1`,-m/2-i+s+g).attr(`y2`,-m/2-i+s+g),g+=s,E.forEach(e=>{o(e).attr(`transform`,`translate( `+-p/2+`, `+(-1*m/2+g)+`)`);let t=e?.getBBox();g+=(t?.height??0)+a}),u.attr(`style`,t.style).attr(`class`,`outer title-state`).attr(`x`,-p/2-i).attr(`y`,-(m/2)-i).attr(`width`,p+t.padding).attr(`height`,m+t.padding),D(t,u),t.intersect=function(e){return M.rect(t,e)},l},V={rhombus:F,composite:ve,question:F,rect:_e,labelRect:ye,rectWithTitle:be,choice:le,circle:Se,doublecircle:Ce,stadium:xe,hexagon:ue,block_arrow:de,rect_left_inv_arrow:fe,lean_right:pe,lean_left:me,trapezoid:he,inv_trapezoid:ge,rect_right_inv_arrow:I,cylinder:L,start:z,end:Te,note:oe,subroutine:we,fork:B,join:B,class_box:Ee};let H={};const De=async(e,t,n)=>{let i,a;if(t.link){let o;r().securityLevel===`sandbox`?o=`_top`:t.linkTarget&&(o=t.linkTarget||`_blank`),i=e.insert(`svg:a`).attr(`xlink:href`,t.link).attr(`target`,o),a=await V[t.shape](i,t,n)}else a=await V[t.shape](e,t,n),i=a;return t.tooltip&&a.attr(`title`,t.tooltip),t.class&&a.attr(`class`,`node default `+t.class),i.attr(`data-node`,`true`),i.attr(`data-id`,t.id),H[t.id]=i,t.haveCallback&&H[t.id].attr(`class`,H[t.id].attr(`class`)+` clickable`),i},Oe=(e,t)=>{H[t.id]=e},ke=()=>{H={}},Ae=e=>{let t=H[e.id];i.trace(`Transforming node`,e.diff,e,`translate(`+(e.x-e.width/2-5)+`, `+e.width/2+`)`);let n=8,r=e.diff||0;return e.clusterNode?t.attr(`transform`,`translate(`+(e.x+r-e.width/2)+`, `+(e.y-e.height/2-n)+`)`):t.attr(`transform`,`translate(`+e.x+`, `+e.y+`)`),r},U=({flowchart:e})=>{var t,n;let r=(t=e?.subGraphTitleMargin)?.top??0,i=(n=e?.subGraphTitleMargin)?.bottom??0,a=r+i;return{subGraphTitleTopMargin:r,subGraphTitleBottomMargin:i,subGraphTitleTotalMargin:a}},W={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:5.3};function G(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=K(e),t=K(t);let[n,r]=[e.x,e.y],[i,a]=[t.x,t.y],o=i-n,s=a-r;return{angle:Math.atan(s/o),deltaX:o,deltaY:s}}const K=e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,q=e=>({x:function(t,n,r){let i=0;if(n===0&&Object.hasOwn(W,e.arrowTypeStart)){let{angle:t,deltaX:n}=G(r[0],r[1]);i=W[e.arrowTypeStart]*Math.cos(t)*(n>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(W,e.arrowTypeEnd)){let{angle:t,deltaX:n}=G(r[r.length-1],r[r.length-2]);i=W[e.arrowTypeEnd]*Math.cos(t)*(n>=0?1:-1)}return K(t).x+i},y:function(t,n,r){let i=0;if(n===0&&Object.hasOwn(W,e.arrowTypeStart)){let{angle:t,deltaY:n}=G(r[0],r[1]);i=W[e.arrowTypeStart]*Math.abs(Math.sin(t))*(n>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(W,e.arrowTypeEnd)){let{angle:t,deltaY:n}=G(r[r.length-1],r[r.length-2]);i=W[e.arrowTypeEnd]*Math.abs(Math.sin(t))*(n>=0?1:-1)}return K(t).y+i}}),J=(e,t,n,r,i)=>{t.arrowTypeStart&&Y(e,`start`,t.arrowTypeStart,n,r,i),t.arrowTypeEnd&&Y(e,`end`,t.arrowTypeEnd,n,r,i)},je={arrow_cross:`cross`,arrow_point:`point`,arrow_barb:`barb`,arrow_circle:`circle`,aggregation:`aggregation`,extension:`extension`,composition:`composition`,dependency:`dependency`,lollipop:`lollipop`},Y=(e,t,n,r,a,o)=>{let s=je[n];if(!s){i.warn(`Unknown arrow type: ${n}`);return}let c=t===`start`?`Start`:`End`;e.attr(`marker-${t}`,`url(${r}#${a}_${o}-${s}${c})`)};let X={},Z={};const Me=()=>{X={},Z={}},Ne=(e,t)=>{let i=n(r().flowchart.htmlLabels),a=t.labelType===`markdown`?l(e,t.label,{style:t.labelStyle,useHtmlLabels:i,addSvgBackground:!0}):T(t.label,t.labelStyle),s=e.insert(`g`).attr(`class`,`edgeLabel`),c=s.insert(`g`).attr(`class`,`label`);c.node().appendChild(a);let u=a.getBBox();if(i){let e=a.children[0],t=o(a);u=e.getBoundingClientRect(),t.attr(`width`,u.width),t.attr(`height`,u.height)}c.attr(`transform`,`translate(`+-u.width/2+`, `+-u.height/2+`)`),X[t.id]=s,t.width=u.width,t.height=u.height;let d;if(t.startLabelLeft){let n=T(t.startLabelLeft,t.labelStyle),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);d=i.node().appendChild(n);let a=n.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),Z[t.id]||(Z[t.id]={}),Z[t.id].startLeft=r,Q(d,t.startLabelLeft)}if(t.startLabelRight){let n=T(t.startLabelRight,t.labelStyle),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);d=r.node().appendChild(n),i.node().appendChild(n);let a=n.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),Z[t.id]||(Z[t.id]={}),Z[t.id].startRight=r,Q(d,t.startLabelRight)}if(t.endLabelLeft){let n=T(t.endLabelLeft,t.labelStyle),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);d=i.node().appendChild(n);let a=n.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),r.node().appendChild(n),Z[t.id]||(Z[t.id]={}),Z[t.id].endLeft=r,Q(d,t.endLabelLeft)}if(t.endLabelRight){let n=T(t.endLabelRight,t.labelStyle),r=e.insert(`g`).attr(`class`,`edgeTerminals`),i=r.insert(`g`).attr(`class`,`inner`);d=i.node().appendChild(n);let a=n.getBBox();i.attr(`transform`,`translate(`+-a.width/2+`, `+-a.height/2+`)`),r.node().appendChild(n),Z[t.id]||(Z[t.id]={}),Z[t.id].endRight=r,Q(d,t.endLabelRight)}return a};function Q(e,t){r().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+`px`,e.style.height=`12px`)}const Pe=(e,t)=>{i.debug(`Moving label abc88 `,e.id,e.label,X[e.id],t);let n=t.updatedPath?t.updatedPath:t.originalPath,a=r(),{subGraphTitleTotalMargin:o}=U(a);if(e.label){let r=X[e.id],a=e.x,c=e.y;if(n){let r=s.calcLabelPosition(n);i.debug(`Moving label `+e.label+` from (`,a,`,`,c,`) to (`,r.x,`,`,r.y,`) abc88`),t.updatedPath&&(a=r.x,c=r.y)}r.attr(`transform`,`translate(${a}, ${c+o/2})`)}if(e.startLabelLeft){let t=Z[e.id].startLeft,r=e.x,i=e.y;if(n){let t=s.calcTerminalLabelPosition(e.arrowTypeStart?10:0,`start_left`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.startLabelRight){let t=Z[e.id].startRight,r=e.x,i=e.y;if(n){let t=s.calcTerminalLabelPosition(e.arrowTypeStart?10:0,`start_right`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.endLabelLeft){let t=Z[e.id].endLeft,r=e.x,i=e.y;if(n){let t=s.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,`end_left`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}if(e.endLabelRight){let t=Z[e.id].endRight,r=e.x,i=e.y;if(n){let t=s.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,`end_right`,n);r=t.x,i=t.y}t.attr(`transform`,`translate(${r}, ${i})`)}},Fe=(e,t)=>{let n=e.x,r=e.y,i=Math.abs(t.x-n),a=Math.abs(t.y-r),o=e.width/2,s=e.height/2;return i>=o||a>=s},Ie=(e,t,n)=>{i.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);let r=e.x,a=e.y,o=Math.abs(r-n.x),s=e.width/2,c=n.x<t.x?s-o:s+o,l=e.height/2,u=Math.abs(t.y-n.y),d=Math.abs(t.x-n.x);if(Math.abs(a-t.y)*s>Math.abs(r-t.x)*l){let e=n.y<t.y?t.y-l-a:a-l-t.y;c=d*e/u;let r={x:n.x<t.x?n.x+c:n.x-d+c,y:n.y<t.y?n.y+u-e:n.y-u+e};return c===0&&(r.x=t.x,r.y=t.y),d===0&&(r.x=t.x),u===0&&(r.y=t.y),i.debug(`abc89 topp/bott calc, Q ${u}, q ${e}, R ${d}, r ${c}`,r),r}else{c=n.x<t.x?t.x-s-r:r-s-t.x;let e=u*c/d,a=n.x<t.x?n.x+d-c:n.x-d+c,o=n.y<t.y?n.y+e:n.y-e;return i.debug(`sides calc abc89, Q ${u}, q ${e}, R ${d}, r ${c}`,{_x:a,_y:o}),c===0&&(a=t.x,o=t.y),d===0&&(a=t.x),u===0&&(o=t.y),{x:a,y:o}}},$=(e,t)=>{i.debug(`abc88 cutPathAtIntersect`,e,t);let n=[],r=e[0],a=!1;return e.forEach(e=>{if(!Fe(t,e)&&!a){let i=Ie(t,r,e),o=!1;n.forEach(e=>{o||=e.x===i.x&&e.y===i.y}),n.some(e=>e.x===i.x&&e.y===i.y)||n.push(i),a=!0}else r=e,a||n.push(e)}),n},Le=function(t,n,a,o,s,l,u){let d=a.points;i.debug(`abc88 InsertEdge: edge=`,a,`e=`,n);let f=!1,p=l.node(n.v);var m=l.node(n.w);m?.intersect&&p?.intersect&&(d=d.slice(1,a.points.length-1),d.unshift(p.intersect(d[0])),d.push(m.intersect(d[d.length-1]))),a.toCluster&&(i.debug(`to cluster abc88`,o[a.toCluster]),d=$(a.points,o[a.toCluster].node),f=!0),a.fromCluster&&(i.debug(`from cluster abc88`,o[a.fromCluster]),d=$(d.reverse(),o[a.fromCluster].node).reverse(),f=!0);let h=d.filter(e=>!Number.isNaN(e.y)),g=e;a.curve&&(s===`graph`||s===`flowchart`)&&(g=a.curve);let{x:_,y:v}=q(a),y=c().x(_).y(v).curve(g),b;switch(a.thickness){case`normal`:b=`edge-thickness-normal`;break;case`thick`:b=`edge-thickness-thick`;break;case`invisible`:b=`edge-thickness-thick`;break;default:b=``}switch(a.pattern){case`solid`:b+=` edge-pattern-solid`;break;case`dotted`:b+=` edge-pattern-dotted`;break;case`dashed`:b+=` edge-pattern-dashed`;break}let x=t.append(`path`).attr(`d`,y(h)).attr(`id`,a.id).attr(`class`,` `+b+(a.classes?` `+a.classes:``)).attr(`style`,a.style),S=``;(r().flowchart.arrowMarkerAbsolute||r().state.arrowMarkerAbsolute)&&(S=window.location.protocol+`//`+window.location.host+window.location.pathname+window.location.search,S=S.replace(/\(/g,`\\(`),S=S.replace(/\)/g,`\\)`)),J(x,a,S,u,s);let C={};return f&&(C.updatedPath=d),C.originalPath=a.points,C};export{J as addEdgeMarkers,Me as clear,ke as clear$1,T as createLabel$1,q as getLineFunctionsWithOffset,U as getSubGraphTitleMargins,Le as insertEdge,Ne as insertEdgeLabel,x as insertMarkers$1,De as insertNode,j as intersectRect$1,E as labelHelper,Pe as positionEdgeLabel,Ae as positionNode,Oe as setNodeElem,D as updateNodeBounds};